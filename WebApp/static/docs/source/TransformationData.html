<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Ext-dirac-core-StateManagement'>/**
</span> * @class Ext.dirac.core.StateManagement This class manages the entire
 *        application platform
 * @mixins Ext.util.Observable
 * 
 */

Ext.define(&#39;Ext.dirac.core.TransformationData&#39;, {
	requires : [],

<span id='Ext-dirac-core-StateManagement-method-oprVerifyDataStructure'>	/**
</span>	 * Function to verify the structure of the saved data and its version
	 */
	oprVerifyDataStructure : function(oData) {
		if (oData &amp;&amp; &quot;version&quot; in oData) {

			if (oData.version == GLOBAL.MAIN_VIEW_SAVE_STRUCTURE_VERSION) {

				return true;

			} else {

				return false;
			}

		} else {

			return false;

		}
	},
	
<span id='Ext-dirac-core-StateManagement-method-oprTransformMainViewDataToCurrentVersion'>	/**
</span>	 * 
	 */
	oprTransformMainViewDataToCurrentVersion : function(oData) {

		var me = this;

		var startVersion = 0;

		if (oData &amp;&amp; &quot;version&quot; in oData) {
			startVersion = oData.version;
		}

		if (startVersion &lt; GLOBAL.MAIN_VIEW_SAVE_STRUCTURE_VERSION) {

			for ( var i = startVersion; i &lt; GLOBAL.MAIN_VIEW_SAVE_STRUCTURE_VERSION; i++) {

				var oResponse = me.oprTransformMainViewDataToNextVersion(i, oData);

				if (!oResponse) {
					return false;
				} else {
					oData = oResponse;
				}

			}

		}
		
		return oData;

	},

<span id='Ext-dirac-core-StateManagement-method-oprTransformMainViewDataToNextVersion'>	oprTransformMainViewDataToNextVersion : function(iVersion, oData) {
</span>
		var me = this;

		if (iVersion &gt;= GLOBAL.MAIN_VIEW_SAVE_STRUCTURE_VERSION) {
			GLOBAL.APP.CF.alert(&quot;You can use this method for version value below &quot; + GLOBAL.MAIN_VIEW_SAVE_STRUCTURE_VERSION, &quot;info&quot;);
			return false;
		}

		var iNextVersion = iVersion + 1;
		var sTransformation = &quot;&quot; + iVersion + &quot;-&quot; + iNextVersion;

		var oResultData = null;

		switch (sTransformation) {

		case &quot;0-1&quot;:
			var oRes = me.oprMainViewGoFrom0To1(oData);
			if (oRes.success) {
				oResultData = oRes.data;
			} else {
				return false;
			}
			break;

		}

		return oResultData;

	},
<span id='Ext-dirac-core-StateManagement-method-oprMainViewGoFrom0To1'>	/**
</span>	 * Function for main view data transformation from version 0 to version 1.
	 * Only this transformation has to rely on specific methods of the views. For
	 * the other transformations this invocation is not needed.
	 * 
	 * 
	 * New version of main view data structure:
	 * 
	 * &lt;pre&gt;
	 * {
	 * 	dirac_view:,
	 * 	version:,
	 * 	data: [{
	 * 					module:,
	 * 					data:,
	 * 					currentState:
	 * 				}*],
	 * 	views:{
	 * 		desktop:{
	 * 			
	 * 		},
	 * 		tabs:{
	 * 
	 * 
	 * 		}
	 * 	}
	 * }
	 * &lt;/pre&gt;
	 */
	oprMainViewGoFrom0To1 : function(oData) {

		var oResponse = {
			success : false,
			data : null
		};

		if (&quot;TD&quot; in GLOBAL.APP.MAIN_VIEW) {
			if (&quot;oprMainViewGoFrom0To1&quot; in GLOBAL.APP.MAIN_VIEW.TD) {
				oResponse.data = GLOBAL.APP.MAIN_VIEW.TD.oprMainViewGoFrom0To1(oData);
				oResponse.success = true;
			}
		}

		return oResponse;

	}

});</pre>
</body>
</html>
